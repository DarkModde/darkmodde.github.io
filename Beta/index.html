<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de AdBlocker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .status {
            text-align: center;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .loading {
            background: rgba(255, 255, 255, 0.2);
            border: 2px dashed rgba(255, 255, 255, 0.5);
        }
        .no-adblock {
            background: rgba(76, 175, 80, 0.3);
            border: 2px solid #4CAF50;
            color: #E8F5E8;
        }
        .adblock-detected {
            background: rgba(244, 67, 54, 0.3);
            border: 2px solid #F44336;
            color: #FFEBEE;
        }
        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .info h3 {
            margin-top: 0;
            color: #FFD700;
        }
        button {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s ease;
            display: block;
            margin: 20px auto;
        }
        button:hover {
            transform: scale(1.05);
        }
        button:active {
            transform: scale(0.95);
        }
        .test-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .method-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .method-status {
            font-weight: bold;
            margin-top: 10px;
            padding: 5px;
            border-radius: 5px;
        }
        .blocked { background: rgba(244, 67, 54, 0.3); color: #FFEBEE; }
        .allowed { background: rgba(76, 175, 80, 0.3); color: #E8F5E8; }
        .testing { background: rgba(255, 193, 7, 0.3); color: #FFF8E1; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è Teste de AdBlocker</h1>
        
        <div id="mainStatus" class="status loading">
            <div class="spinner"></div>
            <div>Verificando se AdBlocker est√° ativo...</div>
        </div>

        <button onclick="runTest()">üîÑ Executar Teste Novamente</button>

        <div class="test-methods">
            <div class="method-card">
                <h4>üìä Google AdSense</h4>
                <div>Script Principal</div>
                <div id="adsense-status" class="method-status testing">Testando...</div>
            </div>
            <div class="method-card">
                <h4>üéØ Google Tag Manager</h4>
                <div>Analytics/Ads</div>
                <div id="gtm-status" class="method-status testing">Testando...</div>
            </div>
            <div class="method-card">
                <h4>üì± Elemento Ads</h4>
                <div>Div com classe "ads"</div>
                <div id="ads-element-status" class="method-status testing">Testando...</div>
            </div>
            <div class="method-card">
                <h4>üîç Fetch API</h4>
                <div>Requisi√ß√£o direta</div>
                <div id="fetch-status" class="method-status testing">Testando...</div>
            </div>
        </div>

        <div class="info">
            <h3>‚ÑπÔ∏è Como funciona este teste?</h3>
            <p>Este teste utiliza v√°rias t√©cnicas para detectar AdBlockers:</p>
            <ul>
                <li><strong>Script do AdSense:</strong> Tenta carregar o script oficial do Google AdSense</li>
                <li><strong>Google Tag Manager:</strong> Verifica se scripts de tracking s√£o bloqueados</li>
                <li><strong>Elemento com classe "ads":</strong> Muitos AdBlockers ocultam elementos com nomes suspeitos</li>
                <li><strong>Requisi√ß√£o Fetch:</strong> Tenta fazer uma requisi√ß√£o para servidores de an√∫ncios</li>
            </ul>
            <p>Se qualquer um destes m√©todos for bloqueado, provavelmente voc√™ est√° usando um AdBlocker.</p>
        </div>
    </div>

    <!-- Elemento teste que AdBlockers costumam ocultar -->
    <div class="ads advertisement banner-ad" id="test-ads-element" style="width: 1px; height: 1px; position: absolute; left: -9999px;">
        Test Ad Element
    </div>

    <script>
        let testResults = {
            adsense: false,
            gtm: false,
            adsElement: false,
            fetchTest: false
        };

        let testsCompleted = 0;
        const totalTests = 4;

        function updateMainStatus() {
            const blockedTests = Object.values(testResults).filter(result => !result).length;
            const mainStatus = document.getElementById('mainStatus');
            
            if (testsCompleted < totalTests) {
                return; // Ainda testando
            }

            if (blockedTests === 0) {
                mainStatus.className = 'status no-adblock';
                mainStatus.innerHTML = '‚úÖ Nenhum AdBlocker detectado!<br><small>Todos os testes passaram normalmente</small>';
            } else if (blockedTests >= 2) {
                mainStatus.className = 'status adblock-detected';
                mainStatus.innerHTML = `üö´ AdBlocker detectado!<br><small>${blockedTests} de ${totalTests} testes foram bloqueados</small>`;
            } else {
                mainStatus.className = 'status adblock-detected';
                mainStatus.innerHTML = `‚ö†Ô∏è Poss√≠vel AdBlocker detectado<br><small>${blockedTests} de ${totalTests} testes foram bloqueados</small>`;
            }
        }

        function completeTest(testName, result) {
            testResults[testName] = result;
            testsCompleted++;
            
            const statusElement = document.getElementById(`${testName.replace(/([A-Z])/g, '-$1').toLowerCase()}-status`);
            if (statusElement) {
                statusElement.className = `method-status ${result ? 'allowed' : 'blocked'}`;
                statusElement.textContent = result ? '‚úÖ Permitido' : 'üö´ Bloqueado';
            }
            
            updateMainStatus();
        }

        // Teste 1: Google AdSense
        function testAdSense() {
            const script = document.createElement('script');
            script.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js';
            script.async = true;
            
            script.onload = function() {
                // Se chegou aqui, o script carregou
                setTimeout(() => {
                    const adsByGoogle = window.adsbygoogle;
                    completeTest('adsense', !!adsByGoogle);
                }, 100);
            };
            
            script.onerror = function() {
                completeTest('adsense', false);
            };
            
            // Timeout de seguran√ßa
            setTimeout(() => {
                if (!testResults.adsense && testsCompleted < totalTests) {
                    completeTest('adsense', false);
                }
            }, 3000);
            
            document.head.appendChild(script);
        }

        // Teste 2: Google Tag Manager
        function testGTM() {
            const script = document.createElement('script');
            script.src = 'https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID';
            script.async = true;
            
            script.onload = function() {
                completeTest('gtm', true);
            };
            
            script.onerror = function() {
                completeTest('gtm', false);
            };
            
            setTimeout(() => {
                if (testsCompleted === 0 || !testResults.gtm) {
                    completeTest('gtm', false);
                }
            }, 3000);
            
            document.head.appendChild(script);
        }

        // Teste 3: Elemento com classe "ads"
        function testAdsElement() {
            setTimeout(() => {
                const adsElement = document.getElementById('test-ads-element');
                const computedStyle = window.getComputedStyle(adsElement);
                const isHidden = computedStyle.display === 'none' || 
                                computedStyle.visibility === 'hidden' || 
                                adsElement.offsetHeight === 0;
                
                completeTest('adsElement', !isHidden);
            }, 1000);
        }

        // Teste 4: Fetch para servidor de an√∫ncios
        function testFetch() {
            fetch('https://googleads.g.doubleclick.net/pagead/id', {
                method: 'GET',
                mode: 'no-cors'
            })
            .then(() => {
                completeTest('fetchTest', true);
            })
            .catch(() => {
                completeTest('fetchTest', false);
            });
            
            // Timeout de seguran√ßa
            setTimeout(() => {
                if (!testResults.fetchTest && Object.keys(testResults).every(key => key !== 'fetchTest' || testResults[key] !== undefined)) {
                    completeTest('fetchTest', false);
                }
            }, 3000);
        }

        function runTest() {
            // Reset
            testResults = {
                adsense: false,
                gtm: false,
                adsElement: false,
                fetchTest: false
            };
            testsCompleted = 0;
            
            // Reset UI
            document.getElementById('mainStatus').className = 'status loading';
            document.getElementById('mainStatus').innerHTML = '<div class="spinner"></div><div>Verificando se AdBlocker est√° ativo...</div>';
            
            const statusElements = ['adsense-status', 'gtm-status', 'ads-element-status', 'fetch-status'];
            statusElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.className = 'method-status testing';
                    element.textContent = 'Testando...';
                }
            });
            
            // Executar testes
            testAdSense();
            testGTM();
            testAdsElement();
            testFetch();
        }

        // Executar teste inicial
        window.addEventListener('load', () => {
            setTimeout(runTest, 500);
        });
    </script>
</body>
</html>
